shiny::runApp()
install.packages("ggplotly")
#library(rjson)
#library(base64enc)
library(plotly)
data<-iris
df<-iris[c(1, 2, 3, 4)]
PC<-prcomp(df)
PCi<-data.frame(PC$x,Species=data$Species)
ggplot(PCi,aes(x=PC1,y=PC2,col=Species))+
geom_point(size=3,alpha=0.5)+ #Size and alpha just for fun
scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))+ #your colors here
theme_classic()
ggplotly(ggplot(PCi,aes(x=PC1,y=PC2,col=Species))+
geom_point(size=3,alpha=0.5)+ #Size and alpha just for fun
scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))+ #your colors here
theme_classic())
PC<-prcomp(df)
PC$x
pca(df, ncomp = input$num_comp, center = T, scale = F)
pca(df, ncomp = 5, center = T, scale = F)
pca(df, ncomp = 4, center = T, scale = F)
p<-pca(df, ncomp = 4, center = T, scale = F)
p<-pca(df, ncomp = 4, center = T, scale = F)
p$X
runApp()
runApp()
View(PCi)
runApp()
runApp()
eigenvalues
X <- as.matrix(df)
Y <- as.factor(to_plot_data$Group)
pca.res2<-pca(X, ncomp = input$num_comp, center = T, scale = F)
pca.res2<-pca(X, ncomp = 4, center = F, scale = F)
eigenvalues<- data.frame(round(pca.res2$explained_variance*100,3))
View(eigenvalues)
colnames(eigenvalues)<-"% Variance Explained"
p<-ggplot(eigenvalues, aes(x=`% Variance Explained`) +
scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D")
p
p<-ggplot(eigenvalues, aes(x=`% Variance Explained`) +
scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D")
)
)
p<-ggplot(eigenvalues, aes(x=`% Variance Explained`) +
p + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D")
p <- ggplot(eigenvalues, aes(x=`% Variance Explained`) +
p<-ggplot(eigenvalues, aes(x=eigenvalues$`% Variance Explained`, y=NULL, fill=NULL)) +
geom_bar(stat="identity")+theme_minimal()
p
eigenvalues$PC<-rownames(eigenvalues)
p<-ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity")+theme_minimal()
p
geom_bar(stat="identity")+theme_minimal()+ scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D")
p<-ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity")+theme_minimal()
p<-ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity")+theme_minimal()
+ scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D")
p + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D")
p<-ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity")+theme_minimal()
p + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D")
p<-ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity")+theme_minimal()
p<-ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity")+theme_minimal()
p + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D")
p + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
p<-ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity")+theme_minimal()
p + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
p
p<-ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity")#+theme_minimal()
p + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
p
p<-ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
p + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
p
screeplot  <- ggplotly(screeplot)
screeplot <- ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`, fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
screeplot + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`,
fill=c("#FF1BB3","#A7FF5B","#99554D"))) +
geom_bar(stat="identity") + theme_minimal()
screeplot + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
screeplot <- ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`,
fill=c("#FF1BB3","#A7FF5B","#99554D"))) +
geom_bar(stat="identity") + theme_minimal()
#screeplot + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
#screeplot + scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
screeplot <- ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
screeplot + scale_fill_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
screeplot
screeplot + scale_fill_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot <- ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
screeplot + scale_fill_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
screeplot <- ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
screeplot + scale_fill_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
screeplot <- ggplot(eigenvalues, aes(x=PC, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
screeplot + scale_fill_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
eigenvalues$`Principal Component`<-rownames(eigenvalues)
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
screeplot + scale_fill_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity") + theme_minimal() +
scale_fill_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity")
+ theme_minimal()
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity") + theme_minimal()
+
scale_fill_manual(values = c("red", "grey", "seagreen3"))
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity")  + scale_fill_manual(values = c("red", "grey", "seagreen3"))
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity")  + scale_fill_manual(values = c("#FF1BB3","#A7FF5B","#99554D","red"))
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL,color=c("#FF1BB3","#A7FF5B","#99554D"))) +
geom_bar(stat="identity")  + theme_minimal()
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL,colour=c("#FF1BB3","#A7FF5B","#99554D"))) +
geom_bar(stat="identity")  + theme_minimal()
screeplot  <- ggplotly(screeplot)
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL,colour=c("#FF1BB3","#A7FF5B","#99554D","blue"))) +
geom_bar(stat="identity")  + theme_minimal()
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=c("#FF1BB3","#A7FF5B","#99554D","blue"),colour=c("#FF1BB3","#A7FF5B","#99554D","blue"))) +
geom_bar(stat="identity")  + theme_minimal()
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL,colour=c("#FF1BB3","#A7FF5B","#99554D","blue"))) +
geom_bar(stat="identity")  + theme_minimal()
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity",fill = c("#FF1BB3","#A7FF5B","#99554D","blue"))  + theme_minimal()
screeplot  <- ggplotly(screeplot)
screeplot
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity",fill = c("#FF1BB3","#A7FF5B","#99554D"))  + theme_minimal()
screeplot  <- ggplotly(screeplot)
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(eigenvalues)))  + theme_minimal()
screeplot  <- ggplotly(screeplot)
screeplot
runApp()
eigenvalues<- eigenvalues[order(eigenvalues$`% Variance Explained`),]
View(eigenvalues)
eigenvalues<- eigenvalues[-order(eigenvalues$`% Variance Explained`),]
View(eigenvalues)
eigenvalues<- eigenvalues[order(-eigenvalues$`% Variance Explained`),]
View(eigenvalues)
eigenvalues<- data.frame(round(pca.res2$explained_variance*100,3))
colnames(eigenvalues)<-"% Variance Explained"
eigenvalues$`Principal Component`<-rownames(eigenvalues)
eigenvalues<- eigenvalues[order(-eigenvalues$`% Variance Explained`),]
View(eigenvalues)
runApp()
shiny::runApp()
X <- as.matrix(df)
df<-iris[,1:4]
Y<-iris[,5]
X <- as.matrix(df)
#Y <- as.factor(to_plot_data$Group)
pca.res2<-pca(X, ncomp = 4, center = F, scale = F)
eigenvalues<- data.frame(round(pca.res2$explained_variance*100,3))
colnames(eigenvalues)<-"% Variance Explained"
View(eigenvalues)
eigenvalues$`Principal Component`<-rownames(eigenvalues)
screeplot <- ggplot(eigenvalues, aes(x=`Principal Component`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(eigenvalues)))  + theme_minimal()
screeplot  <- ggplotly(screeplot)
View(eigenvalues)
eigenvalues<- eigenvalues[order(-eigenvalues$`% Variance Explained`),]
View(eigenvalues)
eigenvalues<-eigenvalues[,1]
eigenvalues<-data.frame(eigenvalues[,1])
eigenvalues$`Principal Component`<-rownames(eigenvalues)
eigenvalues<- data.frame(round(pca.res2$explained_variance*100,3))
colnames(eigenvalues)<-"% Variance Explained"
eigenvalues<- data.frame(round(pca.res2$explained_variance*100,3))
colnames(eigenvalues)<-"% Variance Explained"
eigenvalues$`Principal Component`<-rownames(eigenvalues)
eigenvalues<-data.frame(`% Variance Explained = eigenvalues$`% Variance Explained`)
eigenvalues<-data.frame(`% Variance Explained` = eigenvalues$`% Variance Explained`)
View(eigenvalues)
eigenvalues<- data.frame(round(pca.res2$explained_variance*100,3))
colnames(eigenvalues)<-"% Variance Explained"
eigenvalues$`Principal Component`<-rownames(eigenvalues)
eigenvalues$`Principal Component`<- NULL
View(eigenvalues)
runApp()
runApp()
runApp()
df<-iris[,1:4]
Y<-iris[,5]
X <- as.matrix(df)
plsda.res <- plsda(X, Y, ncomp = 4)
plsda.res$X
plsda <- plotIndiv(plsda.res, group = Y, legend = TRUE,
title = '',
ind.names = FALSE,
size.title = .1, size.xlabel = 1.5,
size.ylabel = 1.5, size.axis = 1.3, size.legend = 1.3,
size.legend.title = 1.3,
comp=c(1,2), ellipse = TRUE, style = "graphics")
plsda.res$X
plsda.res$variates$X
PLSDAi<-data.frame(plsda.res$variates$X, Groups=Y)
plsda <- ggplotly(ggplot(PLSDAi, aes(x=`comp 1`,y=`comp 2`,col=Groups))+
geom_point(size=3,alpha=0.5)+ #Size and alpha just for fun
scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
+ #your colors here
theme_minimal())
PLSDAi
View(PLSDAi)
plsda <- ggplotly(ggplot(PLSDAi, aes(x=comp.1,y=comp.2,col=Groups))+
geom_point(size=3,alpha=0.5)+ #Size and alpha just for fun
scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
+ #your colors here
theme_minimal())
plsda
colnames(PLSDAi)[1:2]<-c("X-Variate 1", "X-Variate 2")
plsda <- ggplotly(ggplot(PLSDAi, aes(x=comp.1,y=comp.2,col=Groups))+
geom_point(size=3,alpha=0.5)+ #Size and alpha just for fun
scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
+ #your colors here
theme_minimal())
plsda <- ggplotly(ggplot(PLSDAi, aes(x=`X-Variate 1`,y=`X-Variate 2`,col=Groups))+
geom_point(size=3,alpha=0.5)+ #Size and alpha just for fun
scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
+ #your colors here
theme_minimal())
plsda
plsda <- ggplotly(ggplot(PLSDAi, aes(x=`X-Variate 1`,y=`X-Variate 2`,col=Groups))+
geom_point(size=3,alpha=0.5)+ #Size and alpha just for fun
scale_color_manual(values = c("#FF1BB3","#A7FF5B","#99554D"))
+ #your colors here
stat_ellipse(aes(x=`X-Variate 1`,y=`X-Variate 2`,col=Groups),type = "norm")
+ theme_minimal())
plsda
runApp()
runApp()
plsda.vip<-as.data.frame(vip(plsda.res))
plsda.vip.top<- plsda.vip[plsda.vip$`comp 1`>input$vip,]
plsda.vip.top<- plsda.vip[plsda.vip$`comp 1`>2,]
plsda.vip.top<-plsda.vip.top[order(plsda.vip.top[,1]),]
####
vip_plsda<- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(eigenvalues)))
+ theme_minimal())
View(plsda.vip.top)
plsda.vip<-as.data.frame(vip(plsda.res))
plsda.vip.top<- plsda.vip[plsda.vip$`comp 1`>2,]
plsda.vip.top<-plsda.vip.top[order(plsda.vip.top[,1]),]
View(plsda.vip.top)
View(plsda.vip)
plsda.vip.top<- plsda.vip[plsda.vip$`comp 1`>1,]
plsda.vip.top<-plsda.vip.top[order(plsda.vip.top[,1]),]
####
vip_plsda<- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=`% Variance Explained`,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(eigenvalues)))
+ theme_minimal())
View(plsda.vip.top)
plsda.vip.top$Variate<- rownames(plsda.vip.top)
vip_plsda<- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=Variates,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(eigenvalues)))
+ theme_minimal())
plsda.vip.top$Variate<- rownames(plsda.vip.top)
vip_plsda<- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=Variate,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(eigenvalues)))
+ theme_minimal())
vip_plsda<- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=Variate,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ theme_minimal())
vip_plsda
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=Variate, y=`comp 1`,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ theme_minimal())
vip_plsda
? geom_bar
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=Variate, y=`comp 1`,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal())
vip_plsda
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=Variate,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal())
vip_plsda
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=Variate,
fill=Variate)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal())
vip_plsda
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=Variate, y=`comp 1`,
fill=Variate)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal())
vip_plsda
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=NULL,
fill=Variate)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal())
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=Variate,
fill=Variate)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal())
+ theme_minimal()) ;vip_plsda
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=Variate,
fill=Variate)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal()) ;vip_plsda
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=`comp 1`, y=Variate,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
#+ coord_flip()
+ theme_minimal()) ;vip_plsda
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=Variate, y=`comp 1`,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal()) ;vip_plsda
runApp()
plsda.vip<-as.data.frame(vip(plsda.res))
plsda.vip.top<- plsda.vip[plsda.vip$`comp 1`>1,]
plsda.vip.top<-plsda.vip.top[order(plsda.vip.top[,1]),]
plsda.vip.top$Variate<- rownames(plsda.vip.top)
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=Variate, y=`comp 1`,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),
nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal())
vip_plsda
colnames(plsda.vip.top$`comp 1`)<- "VIP"
colnames(plsda.vip.top)[1]<- "VIP"
vip_plsda <- ggplotly(ggplot(plsda.vip.top, aes(x=Variate, y=VIP,
fill=NULL)) +
geom_bar(stat="identity", fill = rep(c("lightblue"),
nrow(plsda.vip.top)))
+ coord_flip()
+ theme_minimal())
vip_plsda
runApp()
runApp()
