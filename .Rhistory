ylab("Missing values") +
xlab("") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
}
if (nrow(nas) >= 1){
ggplot(nas, aes(reorder(names, number), number, fill = number)) +
geom_col() +
ylab("Missing values") +
xlab("") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
}
if (nrow(zeros) >= 1){
ggplot(zeros, aes(reorder(names, number), number, fill = number)) +
geom_col() +
ylab("Zeros") +
xlab("") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
}
final_data <- dataX[, !(colnames(dataX) %in% all_zero$names)]
counts <- data.frame(table(samples_group$Group))
View(counts)
colnames(counts) <- c("Group", "Counts")
counts <- data.frame(table(samples_group$Group))
colnames(counts) <- c("Group", "Counts")
ggplot(counts, aes(reorder(Group, Counts), Counts, fill = Group)) +
geom_col() +
ylab("Counts") +
xlab("") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
sum(is.na(dataX))
summary_table <- data.frame(NumberOfSamples = nrow(dataX),
NumberOfFeatures = ncol(dataX),
NumberOfZeros = sum(zeros$number),
PercentageOfZeros = round(sum(zeros$number)/(nrow(dataX)*(ncol(dataX)))*100, 3),
NumberOfNA = sum(is.na(dataX)),
PercentageOfNA = round(sum(is.na(dataX))/(nrow(dataX)*(ncol(dataX)))*100, 3))
sumary_table
summary_table
summary_table <- data.frame(NumberOfSamples = nrow(dataX),
NumberOfFeatures = ncol(dataX),
NumberOfZeros = sum(zeros$number),
PercentageOfZeros = paste(round(sum(zeros$number)/(nrow(dataX)*(ncol(dataX)))*100, 3), "%"),
NumberOfNA = sum(is.na(dataX)),
PercentageOfNA = paste(round(sum(is.na(dataX))/(nrow(dataX)*(ncol(dataX)))*100, 3), "%"))
summary_table
summary_table <- data.frame(NumberOfSamples = nrow(dataX),
NumberOfFeatures = ncol(dataX),
NumberOfZeros = sum(zeros$number),
PercentageOfZeros = paste(round(sum(zeros$number)/(nrow(dataX)*(ncol(dataX)))*100, 3), "%"),
NumberOfNA = sum(is.na(dataX)),
PercentageOfNA = paste(round(sum(is.na(dataX))/(nrow(dataX)*(ncol(dataX)))*100, 3), "%"),
ncol = 1)
summary_table
knit::kable
data2 <- melt(as.data.frame(final_data[, 2:ncol(final_data)]))
View(data2)
indNum <- nrow(data2)
final_data %>%
reshape2::melt() %>%
group_by(ID) %>%
ggplot(aes(ID, value, color = Group)) +
geom_boxplot() +
{if(indNum < 11)geom_jitter()} +
theme_bw() +
xlab("Samples") +
ylab("Value") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
final_data <- dataX[, !(colnames(dataX) %in% all_zero$names)]
final_data <- cbind(samples_group, final_data)
final_data %>%
reshape2::melt() %>%
group_by(ID) %>%
ggplot(aes(ID, value, color = Group)) +
geom_boxplot() +
{if(indNum < 11)geom_jitter()} +
theme_bw() +
xlab("Samples") +
ylab("Value") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
normality <- data.frame(pval = apply(data[,3:ncol(final_data)], 2, function(x) {shapiro.test(x)$p.value}))
final_data %>%
reshape2::melt() %>%
group_by(ID) %>%
ggplot(aes(value, fill = variable, colour = variable)) +
geom_density(alpha = 0.5) +
theme_minimal() +
labs(title = "Density plot for all Features", x = "Value")
p3 <- final_data %>%
reshape2::melt()
View(p3)
p3 <- final_data %>%
reshape2::melt() %>%
group_by(ID) %>%
ggplot(aes(value, fill = Group, colour = Group)) +
geom_density(alpha = 0.5) +
theme_bw() +
labs(title = "Density plot for all Features", x = "Value")
p3
?scale_fill_viridis
X <- as.matrix(final_data[, 3:ncol(final_data)])
Y <- as.factor(final_data$Group)
pca_res <- mixOmics::pca(X, ncomp = 3, center = T, scale = T)
X <- as.matrix(final_data[, 3:ncol(final_data)])
Y <- as.factor(final_data$Group)
####
X[X == 0] <- NA
X <- apply(X, 2, function(x) {if(is.numeric(x)) ifelse(is.na(x), min(x, na.rm = T)/2, x) else x})
pca_res <- mixOmics::pca(X, ncomp = 3, center = T, scale = T)
PCi <- data.frame(pca_res$x, Groups = Y)
ggplot(PCi, aes(x = PC1, y = PC2, color = Groups)) +
geom_point(size = 3, alpha = 0.5) +
xlab(paste0("PC1 (", round(100*(pca_res$explained_variance)[1], 2), "%)")) +
ylab(paste0("PC2 (", round(100*(pca_res$explained_variance)[2], 2), "%)")) +
scale_fill_viridis() +
theme_bw()
X <- as.matrix(final_data[, 3:ncol(final_data)])
Y <- as.factor(final_data$Group)
#### dummy imputation
X[X == 0] <- NA
X <- apply(X, 2, function(x) {if(is.numeric(x)) ifelse(is.na(x), min(x, na.rm = T)/2, x) else x})
####
stat <- function(x) {
t.test(x ~ Group, na.rm = TRUE, alternative = c("two.sided"),
var.equal = input$var_equalV,
paired = input$pairedV)$p.value
}
stat_G2 <- function(x) {
t.test(x ~ Group, na.rm = TRUE, alternative = c("two.sided"),
var.equal = input$var_equalV)$estimate[[2]]
}
stat_G1 <- function(x) {
t.test(x ~ Group, na.rm = TRUE, alternative = c("two.sided"),
var.equal = input$var_equalV)$estimate[[1]]
}
p <- data.frame(pvalue = apply(FUN = stat, MARGIN = 2, X = X))
X <- as.matrix(final_data[, 3:ncol(final_data)])
Group <- as.factor(final_data$Group)
#### dummy imputation
X[X == 0] <- NA
X <- apply(X, 2, function(x) {if(is.numeric(x)) ifelse(is.na(x), min(x, na.rm = T)/2, x) else x})
####
stat <- function(x) {
t.test(x ~ Group, na.rm = TRUE, alternative = c("two.sided"),
var.equal = input$var_equalV,
paired = input$pairedV)$p.value
}
stat_G2 <- function(x) {
t.test(x ~ Group, na.rm = TRUE, alternative = c("two.sided"),
var.equal = input$var_equalV)$estimate[[2]]
}
stat_G1 <- function(x) {
t.test(x ~ Group, na.rm = TRUE, alternative = c("two.sided"),
var.equal = input$var_equalV)$estimate[[1]]
}
p <- data.frame(pvalue = apply(FUN = stat, MARGIN = 2, X = X))
X <- as.matrix(final_data[, 3:ncol(final_data)])
Group <- as.factor(final_data$Group)
#### dummy imputation
X[X == 0] <- NA
X <- apply(X, 2, function(x) {if(is.numeric(x)) ifelse(is.na(x), min(x, na.rm = T)/2, x) else x})
####
stat <- function(x) {
t.test(x ~ Group, na.rm = TRUE, alternative = c("two.sided"),
var.equal = F,
paired = F)$p.value
}
stat_G2 <- function(x) {
t.test(x ~ Group, na.rm = TRUE, alternative = c("two.sided"),
var.equal = F)$estimate[[2]]
}
stat_G1 <- function(x) {
t.test(x ~ Group, na.rm = TRUE, alternative = c("two.sided"),
var.equal = F)$estimate[[1]]
}
p <- data.frame(pvalue = apply(FUN = stat, MARGIN = 2, X = X))
p <- p %>%
rownames_to_column("feature") %>%
as_tibble() %>%
mutate(pvalue_Adj = p.adjust(pvalue, method = "fdr")) %>%
column_to_rownames("feature")
G2 <- round(data.frame(Mean_G2 = apply(FUN = stat_G2, MARGIN = 2, X = X)), 3)
G1 <- round(data.frame(Mean_G1 = apply(FUN = stat_G1, MARGIN = 2, X = X)), 3)
means <- cbind(G1, G2)
means <- means %>%
rownames_to_column("feature") %>%
mutate(Fold_Change_Ratio = as.numeric(round(Mean_G2/Mean_G1, 3)),
Difference_Of_Means = as.numeric(round(Mean_G1 - Mean_G2, 3))) %>%
column_to_rownames("feature")
df <- cbind(means, p)
####
names <- colnames(X)
df <- data.frame(pvalue = df$pvalue, FC = log2(df$Fold_Change_Ratio), names = names)
df <- mutate(df, threshold = as.factor(ifelse(df$pvalue >= 0.05,
yes = "none",
no = ifelse(df$FC < log2(1.5),
yes = ifelse(df$FC < -log2(1.5),
yes = "Down-regulated",
no = "none"),
no = "Up-regulated"))))
volcanoP <- ggplot(data = df, aes(x = FC, y = -log10(pvalue), colour = threshold, label = names)) +
geom_point(size=1.75) +
xlim(c(-5, 5)) +
xlab("log2 Fold Change") +
ylab("-log10 p-value") +
scale_y_continuous(trans = "log1p")+
ggtitle(paste0("Comparisson: ", names(table(samples_groups$Group))[2], "/",
names(table(samples_groups$Group))[1])) +
geom_vline(xintercept = -log2(1.5), colour = "black", linetype = "dashed") +
geom_vline(xintercept = log2(1.5), colour = "black", linetype = "dashed") +
geom_hline(yintercept = -log10(0.05), colour = "black", linetype = "dashed") +
theme(legend.position = "none") +
labs(color = "") +
theme_bw() +
scale_color_manual(values = c("Down-regulated" = "#E64B35", "Up-regulated" = "#3182bd", "none" = "#636363"))
mycorr <- cor(final_data[, 3:ncol(final_data)])
View(mycorr)
X <- as.matrix(final_data[, 3:ncol(final_data)])
#### dummy imputation
X[X == 0] <- NA
X <- apply(X, 2, function(x) {if(is.numeric(x)) ifelse(is.na(x), min(x, na.rm = T)/2, x) else x})
####
mycorr <- cor(X)
mycorr <- which(mycorr > 0.97 & mycorr != 1, arr.ind = TRUE)
X <- as.matrix(final_data[, 3:ncol(final_data)])
X[X == 0] <- NA
X <- apply(X, 2, function(x) {if(is.numeric(x)) ifelse(is.na(x), min(x, na.rm = T)/2, x) else x})
mycorr <- cor(X)
mycorr <- which(mycorr > 0.97 & mycorr != 1, arr.ind = TRUE)
num_corr <- nrow(mycorr)
num_corr
runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
View(zeros)
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
devtools::install_github("pcastellanoescuder/POMA")
shiny::runApp()
POMA::PomaOddsRatio()
POMA::PomaOddsRatio
runApp()
runApp()
?PomaOddsRatio
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?PomaImpute
runApp()
runApp()
target <- readr::read_csv("data/target.csv")
features <- readr::read_csv("data/features.csv")
covariates <- readr::read_csv("data/covariables.csv")
covariates <- covariates %>% dplyr::select(-1)
prepared_data <- bind_cols(target, covariates, features)
targetX <- prepared_data %>% dplyr::select(1, 2:ncol(covariates) + 2)
View(targetX)
featuresX <- prepared_data %>% dplyr::select(-1:2)
View(featuresX)
featuresX <- prepared_data %>% dplyr::select(-1, -2)
View(featuresX)
targetX <- prepared_data[,c (1, 2:ncol(covariates) + 2)]
View(targetX)
targetX <- prepared_data[,c (1, 2:(ncol(covariates) + 2))]
View(targetX)
View(covariates)
featuresX <- prepared_data[, c((ncol(covariates) + 2):ncol(prepared_data))]
View(featuresX)
ncol(covariates) + 2
featuresX <- prepared_data[, c((ncol(covariates) + 3):ncol(prepared_data))]
View(targetX)
targetX <- prepared_data[,c (1, 2:(ncol(covariates) + 2))]
featuresX <- prepared_data[, c((ncol(covariates) + 3):ncol(prepared_data))]
target <- prepared_data %>% dplyr::select(1:2)
features <- prepared_data %>% dplyr::select(-1:2)
View(target)
View(features)
features <- prepared_data %>% dplyr::select(-1, -2)
runApp()
prepared_data <- prepared_data[, c(1:2, (3 + ncol(covariates)):ncol(prepared_data))]
View(prepared_data)
View(features)
runApp()
runApp()
runApp()
runApp()
runApp()
?PomaNorm
?PomaNormPlot
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
POMA::PomaVolcano
?POMA::PomaVolcano
runApp()
devtools::install_github("pcastellanoescuder/POMA")
target <- readr::read_csv("data/target.csv")
features <- readr::read_csv("data/features.csv")
data <- POMA::PomaMSnSetClass(target, features)
POMA::PomaBoxplots
devtools::install_github("pcastellanoescuder/POMA")
devtools::install_github("pcastellanoescuder/POMA", force = T)
library(POMA)
POMA::PomaBoxplots(data)
library(POMA)
POMA::PomaBoxplots(data)
POMA::PomaBoxplots(data, group = "features")
POMA::PomaBoxplots(data, group = "features", feature_name = colnames(features)[1:2])
POMA::PomaBoxplots(data, group = "features", feature_name = colnames(features)[1:2], jitter = F)
shiny::runApp()
runApp()
runApp()
runApp()
PomaUnivariate(data, method = "kruskal")
?PomaUnivariate
##
if (input$univariate_test == "ttest"){
param_ttest <- POMA::PomaUnivariate(data, method = "ttest")
return(param_ttest)
}
runApp()
runApp()
runApp()
runApp()
POMA::PomaMultivariate()
POMA::PomaMultivariate
#
output$pca_scores <- DT::renderDataTable({
DT::datatable(Multivariate_plot()$pca_scores,
filter = 'none',extensions = 'Buttons',
escape=FALSE,  rownames=TRUE, class = 'cell-border stripe',
options = list(
scrollX = TRUE,
dom = 'Bfrtip',
buttons =
list("copy", "print", list(
extend="collection",
buttons=list(list(extend="csv",
filename="POMA_plsda_scores"),
list(extend="excel",
filename="POMA_plsda_scores"),
list(extend="pdf",
filename="POMA_plsda_scores")),
text="Dowload")),
order=list(list(2, "desc")),
pageLength = nrow(Multivariate_plot()$pca_scores)))
})
##
output$ber_table <- DT::renderDataTable({
ber <- Multivariate_plot()$ber
DT::datatable(ber,
filter = 'none',extensions = 'Buttons',
escape=FALSE,  rownames=TRUE, class = 'cell-border stripe',
options = list(
scrollX = TRUE,
dom = 'Bfrtip',
buttons =
list("copy", "print", list(
extend="collection",
buttons=list(list(extend="csv",
filename="POMA_plsda_ber"),
list(extend="excel",
filename="POMA_plsda_ber"),
list(extend="pdf",
filename="POMA_plsda_ber")),
text="Dowload")),
order=list(list(2, "desc")),
pageLength = nrow(Multivariate_plot()$ber)))
})
##
output$vip_table <- DT::renderDataTable({
DT::datatable(Multivariate_plot()$plsda.vip.top,
filter = 'none',extensions = 'Buttons',
escape=FALSE,  rownames=TRUE, class = 'cell-border stripe',
options = list(
scrollX = TRUE,
dom = 'Bfrtip',
buttons =
list("copy", "print", list(
extend="collection",
buttons=list(list(extend="csv",
filename="POMA_plsda_vip"),
list(extend="excel",
filename="POMA_plsda_vip"),
list(extend="pdf",
filename="POMA_plsda_vip")),
text="Dowload")),
order=list(list(2, "desc")),
pageLength = nrow(Multivariate_plot()$plsda.vip.top)))
})
##
output$errors_splsda <- DT::renderDataTable({
errors_splsda_out <- Multivariate_plot()$errors_splsda_out
col_idx <- grep("features", names(errors_splsda_out))
errors_splsda_out <- errors_splsda_out[, c(col_idx, (1:ncol(errors_splsda_out))[-col_idx])]
DT::datatable(errors_splsda_out,
filter = 'none',extensions = 'Buttons',
escape=FALSE,  rownames=FALSE, class = 'cell-border stripe',
options = list(
scrollX = TRUE,
dom = 'Bfrtip',
buttons =
list("copy", "print", list(
extend="collection",
buttons=list(list(extend="csv",
filename="POMA_splsda_errors"),
list(extend="excel",
filename="POMA_splsda_errors"),
list(extend="pdf",
filename="POMA_splsda_errors")),
text="Dowload")),
order=list(list(2, "desc")),
pageLength = nrow(Multivariate_plot()$errors_splsda_out)))
})
?POMA::PomaMultivariate
mixOmics::plsda()
library(POMA)
st000284
data <- st000284
POMA::PomaMultivariate(data, method = "pca", components = input$num_comp, scale = input$scale, center = input$center, ellipse = input$ellipse)
POMA::PomaMultivariate(data, method = "pca")
runApp()
POMA::PomaMultivariate()
POMA::PomaMultivariate
pca_res <- POMA::PomaMultivariate(data, method = "pca")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
res <- POMA::PomaMultivariate(data, method = "plsda")
names(res)
res$errors_plsda
overall_table <- res$errors_plsda
overall_tableX <- overall_table %>% pivot_wider()
overall_tableX <- overall_table %>% pivot_wider(names_from = variable, values_from = value)
View(overall_tableX)
overall_tableX <- overall_table %>%
pivot_wider(names_from = variable, values_from = value) %>%
column_to_rownames("Component") %>%
select_at(vars(starts_with("overall")))
View(overall_table)
runApp()
res <- POMA::PomaMultivariate(data, method = "splsda")
res <- POMA::PomaMultivariate(st000284, method = "splsda")
names(res)
res$ncomp
res$select_keepX
res$errors_splsda
res$bal_error_rate
names(res)
errors_splsda <- res$errors_splsda
errors_splsdaX <- errors_splsda %>%
pivot_wider(names_from = variable, values_from = value)
View(errors_splsdaX)
errors_splsdaX <- errors_splsda %>%
pivot_wider(names_from = variable, values_from = c(value, sd))
View(errors_splsdaX)
errors_splsdaX <- errors_splsda %>%
pivot_wider(names_from = c(features, variable), values_from = c(value, sd))
View(errors_splsdaX)
errors_splsdaX <- errors_splsda %>%
pivot_wider(names_from = features, values_from = c(value, sd))
View(errors_splsdaX)
errors_splsdaX <- errors_splsda %>%
pivot_wider(names_from = variable, values_from = c(value, sd))
View(errors_splsdaX)
errors_splsdaX <- errors_splsda %>%
pivot_wider(names_from = feature, values_from = c(variable, value, sd))
errors_splsdaX <- errors_splsda %>%
pivot_wider(names_from = features, values_from = c(variable, value, sd))
errors_splsdaX <- errors_splsda %>%
pivot_wider(names_from = variable, values_from = c(value, sd))
View(errors_splsdaX)
runApp()
runApp()
runApp()
POMA::PomaMultivariate()
POMA::PomaMultivariate
runApp()
runApp()
devtools::install_github("pcastellanoescuder/POMA")
